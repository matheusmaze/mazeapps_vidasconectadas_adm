{"version":3,"sources":["webpack:///./src/views/Adm/Compras/index.vue","webpack:///./src/views/Adm/Compras/index.vue?2348"],"names":["class","route","name","split","toLowerCase","to","text","substring","length","filtro","type","label","placeholder","data","filterAll","color","headers","buys","options","exports","components","Input","Button","DataTable","setup","key","value","money","badge","router","modal","alert","loader","users","institutions","open","filter","buy","status","forEach","index","institution","institutions_id","id","institutionName","user","users_id","userName","close","includes","localStorage","removeItem","push","deleteItem","deleteFunction","item","cancelFunction","title","message","confirmMessage","callbackOK","callbackCancel","show","r","icon","action","param","render"],"mappings":"0KACOA,MAAM,oB,GACLA,MAAM,0B,GACJA,MAAM,yB,GAKTA,MAAM,gC,GAONA,MAAM,oD,GACJA,MAAM,a,GAcNA,MAAM,Q,mMA7Bb,eAMM,MANN,EAMM,CALJ,eAA+E,KAA/E,EAAmC,YAAS,eAAG,EAAAC,MAAMC,KAAKC,MAAK,YAC/D,eAGO,OAHP,EACG,0DAAuD,eAAE,EAAAF,MAAMC,KAAKC,MAAK,QAASC,eAAe,iCAEpG,KAEF,eAMM,MANN,EAMM,CALJ,eAIc,GAJAC,GAAE,WAAM,EAAAJ,MAAMC,KAAKE,cAAjB,W,yBACd,iBAEE,CAFF,eAEE,GADCE,KAAI,gBAAY,EAAAL,MAAMC,KAAKC,MAAK,QAASI,UAAS,EAAI,EAAAN,MAAMC,KAAKC,MAAK,QAASK,OAAM,GAAOJ,gB,sCAInG,eAkBM,MAlBN,EAkBM,CAjBJ,eAaM,MAbN,EAaM,CAZJ,eAWE,G,WAVS,EAAAK,O,qDAAA,EAAAA,OAAM,IACfC,KAAK,SACLC,MAAM,mBACNC,YAAY,qBACXC,KAAM,C,2KAQX,eAEM,MAFN,EAEM,CADJ,eAA8E,GAArE,QAAO,EAAAC,UAAWC,MAAM,UAAUT,KAAK,UAAUN,MAAM,a,wBAIpE,eAME,GALCgB,QAAS,EAAAA,QACTH,KAAM,EAAAI,KACNC,QAAS,EAAAA,QACTC,SAAS,EACVJ,MAAM,W,oLAYK,GACbb,KAAM,QACNkB,WAAY,CACVC,QAAA,KACAC,SAAA,KACAC,UAAA,QAEFC,MAPa,WAQX,IAAMR,EAAU,CACd,CAAES,IAAK,KAAMC,MAAO,MACpB,CAAED,IAAK,YAAaC,MAAO,YAC3B,CAAED,IAAK,eAAgBC,MAAO,mBAC9B,CAAED,IAAK,QAASC,MAAO,QAASC,OAAO,GACvC,CACEF,IAAK,SACLC,MAAO,SACPE,MAAO,CACL,SAAY,QACZ,UAAa,MACb,WAAc,WAGlB,CAAEH,IAAK,SAAUC,MAAO,KAIpBzB,EAAQ,iBACR4B,EAAS,iBACTC,EAAQ,eAAO,SACfC,EAAQ,eAAO,SACfC,EAAS,eAAO,WAEhBnB,EAAO,eAAI,IACXI,EAAO,eAAI,IACXgB,EAAQ,eAAI,IACZC,EAAe,eAAI,IACnBzB,EAAS,eAAI,IAEbK,EAAQ,yDAAI,8FAChBkB,EAAOG,OACU,UAAjB1B,EAAOiB,MACHT,EAAKS,MAAQb,EAAKa,MAClBT,EAAKS,MAAQb,EAAKa,MAAMU,QAAQ,SAAAC,GAAE,OAAK5B,EAAOiB,QAAUW,EAAIC,UAChErB,EAAKS,MAAMa,SAAS,SAACF,EAAKG,GACxBN,EAAaR,MAAMa,SAAS,SAAAE,GACvBJ,EAAIK,kBAAoBD,EAAYE,KACrC1B,EAAKS,MAAMc,GAAOI,gBAAkBH,EAAYvC,YAItDW,EAAKa,MAAMa,SAAS,SAACF,EAAKG,GACxBP,EAAMP,MAAMa,SAAS,SAAAM,GAChBR,EAAIS,WAAaD,EAAKF,KACvB9B,EAAKa,MAAMc,GAAOO,SAAWF,EAAK3C,YAIxC8B,EAAOgB,QAnBS,2CAAJ,qDAsBd,eAAS,wCAAC,8GAENhB,EAAOG,OAFD,SAGa,eAAI,QAHjB,cAGNtB,EAAKa,MAHC,OAINT,EAAKS,MAAQb,EAAKa,MAJZ,SAKqB,eAAI,gBALzB,cAKNQ,EAAaR,MALP,OAMNT,EAAKS,MAAMa,SAAS,SAACF,EAAKG,GACxBN,EAAaR,MAAMa,SAAS,SAAAE,GACvBJ,EAAIK,kBAAoBD,EAAYE,KACrC1B,EAAKS,MAAMc,GAAOI,gBAAkBH,EAAYvC,YAThD,UAac,eAAI,SAblB,QAaN+B,EAAMP,MAbA,OAcNT,EAAKS,MAAMa,SAAS,SAACF,EAAKG,GACxBP,EAAMP,MAAMa,SAAS,SAAAM,GAChBR,EAAIS,WAAaD,EAAKF,KACvB1B,EAAKS,MAAMc,GAAOO,SAAWF,EAAK3C,YAIxC8B,EAAOgB,QArBD,qDAuBNhB,EAAOgB,QACJ,KAAEC,SAAS,UACZlB,EAAMI,KAAK,WAAX,KAA0B,UAC1Be,aAAaC,WAAW,SACxBD,aAAaC,WAAW,QACxBtB,EAAOuB,KAAK,WAEZrB,EAAMI,KAAK,WAAX,KAA0B,UA9BtB,2DAmCV,IAAMkB,EAAa,SAAChB,GAClB,IAAMiB,EAAa,yDAAI,qGACrBtB,EAAOG,OADc,kBAGb,eAAO,QAAD,OAASE,EAAIM,KAHN,OAInB1B,EAAKS,MAAQT,EAAKS,MAAMU,QAAO,SAACmB,GAAD,OAAUA,EAAKZ,IAAMN,EAAIM,MACxD9B,EAAKa,MAAQb,EAAKa,MAAMU,QAAO,SAACmB,GAAD,OAAUA,EAAKZ,IAAMN,EAAIM,MACxDX,EAAOgB,QACPjB,EAAMI,KAAK,WAAX,+BAAuD,WAPpC,qDASnBH,EAAOgB,QACPjB,EAAMI,KAAK,OAAX,KAAsB,UAVH,0DAAJ,qDAcbqB,EAAiB,WACrB1B,EAAMkB,SAGRlB,EAAMK,KAAK,CACTsB,MAAO,UACPC,QAAS,wCACTC,eAAgB,YAChBC,WAAY,kBAAMN,KAClBO,eAAgB,kBAAML,OAIxBxB,EAAOgB,SAGHc,EAAO,SAACC,GACZlC,EAAOuB,KAAP,WAAgBnD,EAAMC,KAAKE,cAA3B,mBAAmD2D,EAAEpB,MAGjDzB,EAAU,CACd,CAAE8C,KAAM,MAAOC,OAAQ,SAACC,GAAD,OAAWJ,EAAKI,IAAQT,MAAO,iBACtD,CAAEO,KAAM,QAASC,OAAQ,SAACC,GAAD,OAAWb,EAAWa,IAAQT,MAAO,mBAGhE,MAAO,CAAEzC,UAASE,UAASjB,QAAOY,OAAMJ,SAAQK,YAAWG,UCxL/D,EAAOkD,OAASA,EAED","file":"js/chunk-2d0d7702.81270a41.js","sourcesContent":["<template>\r\n  <div class=\"w-full mt-6 mb-8\">\r\n    <h3 class=\"font-bold text-primary\">Lista de {{ route.name.split('/')[1] }}</h3>\r\n    <span class=\"text-sm text-gray-500\"\r\n      >Aqui você pode observar todos os itens relacionados às {{route.name.split('/')[1].toLowerCase()}} como\r\n      suas respectivas ações.\r\n    </span>\r\n  </div>\r\n  <div class=\"flex mb-6 justify-end w-full\">\r\n    <router-link :to=\"`/${route.name.toLowerCase()}/criar`\">\r\n      <Button\r\n        :text=\"`Criar ${(route.name.split('/')[1].substring(0, route.name.split('/')[1].length - 1)).toLowerCase()}`\"\r\n      />\r\n    </router-link>\r\n  </div>\r\n  <div class=\"flex flex-row my-12 items-baseline justify-start\">\r\n    <div class=\"w-56 mr-3\">\r\n      <Input\r\n        v-model=\"filtro\"\r\n        type=\"select\"\r\n        label=\"Status da compra\"\r\n        placeholder=\"Selecione o status\"\r\n        :data=\"[\r\n          { label: 'Todas', value: 'todas' },\r\n          { label: 'Aprovada', value: 'Aprovada' },\r\n          { label: 'Reprovada', value: 'Reprovada' },\r\n          { label: 'Aguardando', value: 'Aguardando' },\r\n        ]\"\r\n      />\r\n    </div>\r\n    <div class=\"w-56\">\r\n      <Button @click=\"filterAll\" color=\"primary\" text=\"Filtrar\" class=\"w-24 h-14\" />\r\n    </div>\r\n  </div>\r\n\r\n  <DataTable\r\n    :headers=\"headers\"\r\n    :data=\"buys\"\r\n    :options=\"options\"\r\n    :exports=\"true\"\r\n    color=\"primary\"\r\n  />\r\n</template>\r\n\r\n<script>\r\nimport Button from \"../../../components/Elements/Button.vue\";\r\nimport DataTable from \"../../../components/Elements/Datatable.vue\";\r\nimport Input from \"../../../components/Elements/Input.vue\";\r\nimport { inject, onMounted, ref } from \"vue\";\r\nimport { GET, DELETE } from \"../../../services/api\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\n\r\nexport default {\r\n  name: \"users\",\r\n  components: {\r\n    Input,\r\n    Button,\r\n    DataTable,\r\n  },\r\n  setup() {\r\n    const headers = [\r\n      { key: \"ID\", value: \"id\"},\r\n      { key: \"Comprador\", value: \"userName\"},\r\n      { key: \"Instituições\", value: \"institutionName\"},\r\n      { key: \"Valor\", value: \"value\", money: true},\r\n      { \r\n        key: \"Status\", \r\n        value: \"status\", \r\n        badge: { \r\n          \"Aprovada\": \"green\", \r\n          \"Reprovada\": \"red\",\r\n          \"Aguardando\": \"yellow\",\r\n        } \r\n      },\r\n      { key: \"Opções\", value: \"\"},\r\n    ];\r\n\r\n\r\n    const route = useRoute();\r\n    const router = useRouter();\r\n    const modal = inject(\"modal\");\r\n    const alert = inject(\"alert\");\r\n    const loader = inject(\"loading\");\r\n\r\n    const data = ref([]);\r\n    const buys = ref([]);\r\n    const users = ref([]);\r\n    const institutions = ref([]);\r\n    const filtro = ref('');\r\n\r\n    const filterAll = async () => {\r\n      loader.open();\r\n      filtro.value === 'todas' \r\n        ? buys.value = data.value\r\n        : buys.value = data.value.filter( buy => filtro.value === buy.status);\r\n      buys.value.forEach( (buy, index) => {\r\n        institutions.value.forEach( institution => {\r\n          if(buy.institutions_id === institution.id){\r\n            buys.value[index].institutionName = institution.name;\r\n          }\r\n        });\r\n      });\r\n      data.value.forEach( (buy, index) => {\r\n        users.value.forEach( user => {\r\n          if(buy.users_id === user.id){\r\n            data.value[index].userName = user.name;\r\n          }\r\n        });\r\n      });\r\n      loader.close();\r\n    };\r\n\r\n    onMounted(async () => {\r\n      try {\r\n        loader.open();\r\n        data.value = await GET(\"buys\");\r\n        buys.value = data.value;\r\n        institutions.value = await GET(\"institutions\");\r\n        buys.value.forEach( (buy, index) => {\r\n          institutions.value.forEach( institution => {\r\n            if(buy.institutions_id === institution.id){\r\n              buys.value[index].institutionName = institution.name;\r\n            }\r\n          });\r\n        });\r\n        users.value = await GET(\"users\");\r\n        buys.value.forEach( (buy, index) => {\r\n          users.value.forEach( user => {\r\n            if(buy.users_id === user.id){\r\n              buys.value[index].userName = user.name;\r\n            }\r\n          });\r\n        });\r\n        loader.close();\r\n      } catch (e) {\r\n        loader.close();\r\n        if(e.includes(\"Token\")) {\r\n          alert.open(\"Atenção!\", e, \"danger\");\r\n          localStorage.removeItem('token');\r\n          localStorage.removeItem('info');\r\n          router.push('/login');\r\n        } else {\r\n          alert.open(\"Atenção!\", e, \"danger\");\r\n        }\r\n      }\r\n    });\r\n\r\n    const deleteItem = (buy) => {\r\n      const deleteFunction = async function () {\r\n        loader.open();\r\n        try {\r\n          await DELETE(`buys/${buy.id}`);\r\n          buys.value = buys.value.filter((item) => item.id != buy.id);\r\n          data.value = data.value.filter((item) => item.id != buy.id);\r\n          loader.close();\r\n          alert.open(\"Sucesso!\", `Compra deletada com sucesso!`, \"success\");\r\n        } catch (e) {\r\n          loader.close();\r\n          alert.open(\"Erro\", e, \"danger\");\r\n        }\r\n      };\r\n\r\n      const cancelFunction = () => {\r\n        modal.close()\r\n      }\r\n     \r\n      modal.open({\r\n        title: \"Atenção\",\r\n        message: \"Deseja realmente excluir essa compra?\",\r\n        confirmMessage: \"Confirmar\",\r\n        callbackOK: () => deleteFunction(),\r\n        callbackCancel: () => cancelFunction(),\r\n      })\r\n\r\n\r\n      loader.close();\r\n    };\r\n\r\n    const show = (r) => {\r\n      router.push(`/${route.name.toLowerCase()}/editar/${r.id}`);\r\n    };\r\n\r\n    const options = [\r\n      { icon: \"pen\", action: (param) => show(param), title: 'Editar compra' },\r\n      { icon: \"trash\", action: (param) => deleteItem(param), title: 'Excluir compra' },\r\n    ];\r\n\r\n    return { headers, options, route, data, filtro, filterAll, buys};\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","import { render } from \"./index.vue?vue&type=template&id=17baf76b\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}