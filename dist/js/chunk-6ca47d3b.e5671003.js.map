{"version":3,"sources":["webpack:///./src/views/Comprador/Dashboard/index.vue","webpack:///./src/views/Comprador/Dashboard/index.vue?991c","webpack:///./src/views/Comprador/Dashboard/index.vue?e96d"],"names":["class","to","route","path","text","filtro","type","label","data","filterAll","color","headers","buys","options","name","components","Input","DataTable","Button","setup","key","value","money","date","badge","modal","alert","loader","users","router","institutions","open","filter","buy","status","forEach","index","institution","institutions_id","id","institutionName","close","info","JSON","parse","localStorage","getItem","includes","removeItem","push","deleteItem","deleteFunction","item","cancelFunction","title","message","confirmMessage","callbackOK","callbackCancel","show","r","icon","action","param","render","__scopeId"],"mappings":"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","file":"js/chunk-6ca47d3b.e5671003.js","sourcesContent":["<template>\r\n  <div class=\"home w-full mt-6 mb-8\">\r\n    <h2 class=\"font-bold dark:text-gray-200 text-primary\">\r\n      Suas compras\r\n    </h2>\r\n    <span class=\"text-sm text-gray-500\"\r\n      >Aqui você pode observar todos os itens relacionados às suas compras.\r\n    </span>\r\n  </div>\r\n  <div class=\"flex mb-6 justify-end w-full\">\r\n    <router-link :to=\"`${route.path}/criar`\">\r\n      <Button\r\n        :text=\"`Criar compra`\"\r\n      />\r\n    </router-link>\r\n  </div>\r\n  <div class=\"flex flex-row my-12 items-baseline justify-start\">\r\n    <div class=\"w-56 mr-3\">\r\n      <Input\r\n        v-model=\"filtro\"\r\n        type=\"select\"\r\n        label=\"Status da compra\"\r\n        :data=\"[\r\n          { label: 'Todas', value: 'todas' },\r\n          { label: 'Aprovada', value: 'Aprovada' },\r\n          { label: 'Reprovada', value: 'Reprovada' },\r\n          { label: 'Aguardando', value: 'Aguardando' },\r\n        ]\"\r\n      />\r\n    </div>\r\n    <div class=\"w-56\">\r\n      <Button @click=\"filterAll\" color=\"primary\" text=\"Filtrar\" class=\"w-24 h-14\" />\r\n    </div>\r\n  </div>\r\n  <DataTable\r\n    :headers=\"headers\"\r\n    :data=\"buys\"\r\n    :options=\"options\"\r\n    color=\"primary\"\r\n  />\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent, inject, onMounted, ref, watch } from \"vue\";\r\nimport DataTable from \"../../../components/Elements/Datatable.vue\";\r\nimport Button from \"../../../components/Elements/Button.vue\";\r\nimport Input from \"../../../components/Elements/Input.vue\";\r\nimport { GET, DELETE } from \"../../../services/api\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\n\r\nexport default defineComponent({\r\n  name: \"Home\",\r\n  components: {\r\n    Input,\r\n    DataTable,\r\n    Button\r\n  },\r\n\r\n  setup() {\r\n    const headers = [\r\n      { key: \"ID\", value: \"id\"},\r\n      { key: \"Instituições\", value: \"institutionName\"},\r\n      { key: \"Valor\", value: \"value\", money: true},\r\n      { key: \"Data\", value: \"created_at\", date: true},\r\n      { \r\n        key: \"Status\", \r\n        value: \"status\", \r\n        badge: { \r\n          \"Aprovada\": \"green\", \r\n          \"Reprovada\": \"red\",\r\n          \"Aguardando\": \"yellow\",\r\n        } \r\n      },\r\n      { key: \"Opções\", value: \"\"},\r\n    ];\r\n\r\n    const modal = inject(\"modal\");\r\n    const alert = inject(\"alert\");\r\n    const loader = inject(\"loading\");\r\n    const users = ref([]);\r\n    const route = useRoute();\r\n    const router = useRouter();\r\n    const data = ref([]);\r\n    const buys = ref([]);\r\n    const institutions = ref([]); \r\n    const filtro = ref('todas');\r\n    const options = ref([]);\r\n\r\n    const filterAll = async () => {\r\n      loader.open();\r\n      filtro.value === 'todas' \r\n        ? buys.value = data.value\r\n        : buys.value = data.value.filter( buy => filtro.value === buy.status);\r\n      buys.value.forEach( (buy, index) => {\r\n        institutions.value.forEach( institution => {\r\n          if(buy.institutions_id === institution.id){\r\n            buys.value[index].institutionName = institution.name;\r\n          }\r\n        });\r\n      });\r\n      loader.close();\r\n    };\r\n\r\n    onMounted(async () => {\r\n      loader.open();\r\n      try {\r\n        const info = JSON.parse(localStorage.getItem(\"info_vidas\"));\r\n        data.value = await GET(`buys/users/${info.id}`);\r\n        buys.value = data.value;\r\n        institutions.value = await GET(\"institutions\");\r\n        buys.value.forEach( (buy, index) => {\r\n          institutions.value.forEach( institution => {\r\n            if(buy.institutions_id === institution.id){\r\n              buys.value[index].institutionName = institution.name;\r\n            }\r\n          });\r\n        });\r\n        loader.close();\r\n      } catch (e) {\r\n        loader.close();\r\n        if(e.includes(\"Token\")) {\r\n          alert.open(\"Atenção!\", e, \"danger\");\r\n          localStorage.removeItem('token');\r\n          localStorage.removeItem('info');\r\n          router.push('/login');\r\n        } else {\r\n          alert.open(\"Atenção!\", e, \"danger\");\r\n        }\r\n      }\r\n    });\r\n\r\n    const deleteItem = (buy) => {\r\n      loader.open();\r\n      const deleteFunction = async function () {\r\n        try {\r\n          loader.open();\r\n          await DELETE(`buys/${buy.id}`);\r\n          buys.value = buys.value.filter((item) => item.id != buy.id);\r\n          data.value = data.value.filter((item) => item.id != buy.id);\r\n          loader.close();\r\n          alert.open(\"Sucesso!\", `Compra deletada com sucesso!`, \"success\");\r\n        } catch (e) {\r\n          loader.close();\r\n          alert.open(\"Erro\", e, \"danger\");\r\n        }\r\n      };\r\n\r\n      const cancelFunction = () => {\r\n        modal.close()\r\n      }\r\n     \r\n      modal.open({\r\n        title: \"Atenção\",\r\n        message: \"Deseja realmente excluir esse item?\",\r\n        confirmMessage: \"Confirmar\",\r\n        callbackOK: () => deleteFunction(),\r\n        callbackCancel: () => cancelFunction(),\r\n      })\r\n\r\n      loader.close();\r\n    };\r\n\r\n    const show = (r) => {\r\n      router.push(`/comprador/editar/${r.id}`);\r\n    };\r\n\r\n    options.value = [\r\n      { icon: \"pen\", action: (param) => show(param), route: 'comprador', title: 'Editar compra' },\r\n      { icon: \"trash\", action: (param) => deleteItem(param), route: 'comprador', title: 'Excluir compra' },\r\n    ];\r\n\r\n    return {\r\n      data,\r\n      buys,\r\n      headers,\r\n      options,\r\n      users,\r\n      status,\r\n      route,\r\n      filtro,\r\n      filterAll\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n  .title{\r\n    border-bottom: 2.5px solid #9EADBA;\r\n    padding-bottom: 2rem;\r\n  }\r\n\r\n  .container{\r\n    display: flex;\r\n    flex-flow: row wrap;\r\n  }\r\n\r\n  @media only screen and (min-width: 950px) {\r\n    .container{\r\n      flex-flow: row nowrap;\r\n    }\r\n  }\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=de5b38b2&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=de5b38b2&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-de5b38b2\"\n\nexport default script","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=de5b38b2&scoped=true&lang=css\""],"sourceRoot":""}